<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>9 Biomarker Discovery | IMAP: Integrated Microbiome Analysis Pipelines</title>
<meta name="author" content="Teresia Mrema-Buza">
<meta name="description" content="Biomarker discovery aims to identify distinct markers or indicators that offer valuable insights into health and disease. These identified biomarkers provide crucial information regarding various...">
<meta name="generator" content="bookdown 0.39 with bs4_book()">
<meta property="og:title" content="9 Biomarker Discovery | IMAP: Integrated Microbiome Analysis Pipelines">
<meta property="og:type" content="book">
<meta property="og:url" content="https://tmbuza.github.io/imap-statistical-analysis/biomarker-discovery.html">
<meta property="og:description" content="Biomarker discovery aims to identify distinct markers or indicators that offer valuable insights into health and disease. These identified biomarkers provide crucial information regarding various...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="9 Biomarker Discovery | IMAP: Integrated Microbiome Analysis Pipelines">
<meta name="twitter:description" content="Biomarker discovery aims to identify distinct markers or indicators that offer valuable insights into health and disease. These identified biomarkers provide crucial information regarding various...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/Sen-0.4.9/font.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=DM%20Mono&amp;display=swap" rel="stylesheet">
<link href="libs/Bitter-0.4.9/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.7.0/transition.js"></script><script src="libs/bs3compat-0.7.0/tabs.js"></script><script src="libs/bs3compat-0.7.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="End-to-End Practical User Guides Using Integrated Approaches"><big>IMAP:</big> Integrated Microbiome Analysis Pipelines</a>:
        <small class="text-muted">End-to-End Practical User Guides Using Integrated Approaches</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">IMAP-Part 09: Statistical Analysis of Microbiome Data</a></li>
<li class="book-part">PREFACE</li>
<li><a class="" href="statistical-analysis-techniques.html"><span class="header-section-number">1</span> Statistical Analysis Techniques</a></li>
<li class="book-part">HYPOTHESIS TESTING</li>
<li><a class="" href="testing-microbial-community-composition.html"><span class="header-section-number">2</span> Testing Microbial Community Composition</a></li>
<li><a class="" href="permanova.html"><span class="header-section-number">3</span> PERMANOVA: Permutation Analysis of Variance</a></li>
<li><a class="" href="population-wise-multivariate-anova.html"><span class="header-section-number">4</span> Population-wise multivariate ANOVA</a></li>
<li><a class="" href="core-taxa-multivariate-anova.html"><span class="header-section-number">5</span> Core taxa multivariate ANOVA</a></li>
<li><a class="" href="differential-abundance-analysis.html"><span class="header-section-number">6</span> Differential Abundance Analysis</a></li>
<li><a class="" href="wilcoxon-rank-sum-and-signed-rank-tests.html"><span class="header-section-number">7</span> Wilcoxon Rank Sum and Signed Rank Tests</a></li>
<li><a class="" href="kruskal-wallis-test.html"><span class="header-section-number">8</span> Kruskal-Wallis test</a></li>
<li><a class="active" href="biomarker-discovery.html"><span class="header-section-number">9</span> Biomarker Discovery</a></li>
<li class="book-part">APPENDIX</li>
<li><a class="" href="imap-github-repos.html"><span class="header-section-number">A</span> IMAP GitHub Repos</a></li>
<li><a class="" href="session-information.html"><span class="header-section-number">B</span> Session Information</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/tmbuza/imap-machine-learning">View book source <i class="fas fa-air-freshener"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="biomarker-discovery" class="section level1" number="9">
<h1>
<span class="header-section-number">9</span> Biomarker Discovery<a class="anchor" aria-label="anchor" href="#biomarker-discovery"><i class="fas fa-link"></i></a>
</h1>
<p>Biomarker discovery aims to identify distinct markers or indicators that offer valuable insights into health and disease. These identified biomarkers provide crucial information regarding various aspects. Employing machine learning techniques, such as <code>random forest classification</code>, can further enhance the understanding by providing more in-depth insights, including:</p>
<ul>
<li>Facilitating disease diagnosis</li>
<li>Monitoring and evaluating treatment responses</li>
<li>Improving comprehension of underlying biological processes</li>
<li>Enabling the prediction of outcomes.</li>
</ul>
<p>Microbial R package performms Random Forest Classification then computes the Confusion Matrix as a means of evaluating the modelâ€™s performance.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="biomarker-discovery.html#cb17-1" tabindex="-1"></a><span class="do">## Biomarkers using microbial package {#microbial-pkg-markers}</span></span>
<span id="cb17-2"><a href="biomarker-discovery.html#cb17-2" tabindex="-1"></a><span class="fu">library</span>(microbial)</span>
<span id="cb17-3"><a href="biomarker-discovery.html#cb17-3" tabindex="-1"></a></span>
<span id="cb17-4"><a href="biomarker-discovery.html#cb17-4" tabindex="-1"></a><span class="fu">biomarker</span>(ps_raw, <span class="at">group =</span> <span class="st">"nationality"</span>, <span class="at">ntree =</span> <span class="dv">129</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-5"><a href="biomarker-discovery.html#cb17-5" tabindex="-1"></a><span class="fu">plotmarker</span>(<span class="at">level=</span><span class="st">"Genus"</span>) <span class="sc">+</span></span>
<span id="cb17-6"><a href="biomarker-discovery.html#cb17-6" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb17-7"><a href="biomarker-discovery.html#cb17-7" tabindex="-1"></a>  <span class="fu">theme_test</span>() <span class="sc">+</span></span>
<span id="cb17-8"><a href="biomarker-discovery.html#cb17-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>)</span>
<span id="cb17-9"><a href="biomarker-discovery.html#cb17-9" tabindex="-1"></a></span>
<span id="cb17-10"><a href="biomarker-discovery.html#cb17-10" tabindex="-1"></a>Call<span class="sc">:</span></span>
<span id="cb17-11"><a href="biomarker-discovery.html#cb17-11" tabindex="-1"></a> <span class="fu">randomForest</span>(<span class="at">formula =</span> group <span class="sc">~</span> ., <span class="at">data =</span> data, <span class="at">importance =</span> <span class="cn">TRUE</span>,      <span class="at">proximity =</span> <span class="cn">TRUE</span>, <span class="at">ntree =</span> ntree) </span>
<span id="cb17-12"><a href="biomarker-discovery.html#cb17-12" tabindex="-1"></a>               Type of random forest<span class="sc">:</span> classification</span>
<span id="cb17-13"><a href="biomarker-discovery.html#cb17-13" tabindex="-1"></a>                     Number of trees<span class="sc">:</span> <span class="dv">129</span></span>
<span id="cb17-14"><a href="biomarker-discovery.html#cb17-14" tabindex="-1"></a>No. of variables tried at each split<span class="sc">:</span> <span class="dv">8</span></span>
<span id="cb17-15"><a href="biomarker-discovery.html#cb17-15" tabindex="-1"></a></span>
<span id="cb17-16"><a href="biomarker-discovery.html#cb17-16" tabindex="-1"></a>        OOB estimate of  error rate<span class="sc">:</span> <span class="fl">4.95</span>%</span>
<span id="cb17-17"><a href="biomarker-discovery.html#cb17-17" tabindex="-1"></a>Confusion matrix<span class="sc">:</span></span>
<span id="cb17-18"><a href="biomarker-discovery.html#cb17-18" tabindex="-1"></a>    AAM AFR class.error</span>
<span id="cb17-19"><a href="biomarker-discovery.html#cb17-19" tabindex="-1"></a>AAM <span class="dv">116</span>   <span class="dv">7</span>  <span class="fl">0.05691057</span></span>
<span id="cb17-20"><a href="biomarker-discovery.html#cb17-20" tabindex="-1"></a>AFR   <span class="dv">4</span>  <span class="dv">95</span>  <span class="fl">0.04040404</span></span></code></pre></div>
<div class="inline-figure"><img src="figures/biomarker_plot-1.png" width="576"></div>
<div id="lefse-linear-discriminant-analysis-lda-and-effect-size" class="section level2" number="9.1">
<h2>
<span class="header-section-number">9.1</span> LEfSe: Linear Discriminant Analysis (LDA) and Effect Size<a class="anchor" aria-label="anchor" href="#lefse-linear-discriminant-analysis-lda-and-effect-size"><i class="fas fa-link"></i></a>
</h2>
<p>In microbiome statistical analysis, Linear Discriminant Analysis (LDA) serves as a valuable tool for both classification and understanding the discriminatory power of microbial features. With the vast complexity of microbiome data, LDA aids in deciphering which microbial taxa contribute most significantly to differences between groups.</p>
<p>By examining effect sizes, researchers can pinpoint key microbial features driving group distinctions, shedding light on the biological mechanisms underlying observed differences. This deeper understanding enhances the interpretation of microbiome data and facilitates the identification of biomarkers associated with specific health conditions or environmental factors.</p>
<p>Here we demonstrate the application of LDA and effect size measures in microbiome statistical analysis. Through these examples, weâ€™ll illustrate how these techniques show the relationships within microbial communities and their associations with various biological and environmental factors.</p>
</div>
<div id="fitting-lda-models-from-phyloseq-object" class="section level2" number="9.2">
<h2>
<span class="header-section-number">9.2</span> Fitting LDA models from phyloseq object<a class="anchor" aria-label="anchor" href="#fitting-lda-models-from-phyloseq-object"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">microbial</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fitting LDA models for nationality</span></span>
<span><span class="va">lda_nat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/microbial/man/ldamarker.html">ldamarker</a></span><span class="op">(</span><span class="va">ps_raw</span>, group <span class="op">=</span> <span class="st">"nationality"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plotting LDA for nationality (African American vs. African)</span></span>
<span><span class="va">lda_nat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/microbial/man/plotLDA.html">plotLDA</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AAM"</span>, <span class="st">"AFR"</span><span class="op">)</span>, lda <span class="op">=</span> <span class="fl">4.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="figures/lefse_LDA-1.png" width="672"></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Fitting LDA models for BMI</span></span>
<span><span class="va">lda_bmi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/microbial/man/ldamarker.html">ldamarker</a></span><span class="op">(</span><span class="va">ps_raw</span>, group <span class="op">=</span> <span class="st">"bmi_group"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plotting LDA for BMI (lean vs. overweight)</span></span>
<span><span class="va">lda_bmi</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/microbial/man/plotLDA.html">plotLDA</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lean"</span>, <span class="st">"overweight"</span><span class="op">)</span>, lda <span class="op">=</span> <span class="fl">4.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="figures/lefse_LDA-2.png" width="672"></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Plotting LDA for BMI (lean vs. obese)</span></span>
<span><span class="va">lda_bmi</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/microbial/man/plotLDA.html">plotLDA</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lean"</span>, <span class="st">"obese"</span><span class="op">)</span>, lda <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="figures/lefse_LDA-3.png" width="672"></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Plotting LDA for BMI (overweight vs. obese)</span></span>
<span><span class="va">lda_bmi</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/microbial/man/plotLDA.html">plotLDA</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"overweight"</span>, <span class="st">"obese"</span><span class="op">)</span>, lda <span class="op">=</span> <span class="fl">4.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="figures/lefse_LDA-4.png" width="672"></div>

</div>
</div>



  <div class="chapter-nav">
<div class="prev"><a href="kruskal-wallis-test.html"><span class="header-section-number">8</span> Kruskal-Wallis test</a></div>
<div class="next"><a href="imap-github-repos.html"><span class="header-section-number">A</span> IMAP GitHub Repos</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#biomarker-discovery"><span class="header-section-number">9</span> Biomarker Discovery</a></li>
<li><a class="nav-link" href="#lefse-linear-discriminant-analysis-lda-and-effect-size"><span class="header-section-number">9.1</span> LEfSe: Linear Discriminant Analysis (LDA) and Effect Size</a></li>
<li><a class="nav-link" href="#fitting-lda-models-from-phyloseq-object"><span class="header-section-number">9.2</span> Fitting LDA models from phyloseq object</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/tmbuza/imap-machine-learning/blob/gh-pages/01_statistical_analysis.Rmd">View source <i class="fas fa-air-freshener"></i></a></li>
          <li><a id="book-edit" href="https://github.com/tmbuza/imap-machine-learning/edit/gh-pages/01_statistical_analysis.Rmd">Edit this page <i class="fas fa-air-freshener"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container">
    <div class="row">
      <div class="col-12 col-md-6 mt-3">
        <p><strong><u><a class="text-light" href="https://microbiome.complexdatainsights.com"><big>IMAP:</big> Integrated Microbiome Analysis Pipelines</a></u></strong>: End-to-End Practical User Guides Using Integrated Approaches</p>
<br><p>Authored by Teresia Mrema-Buza, Last updated: <b>2024-04-26</b>.</p>
<br>
</div>
      <div class="col-12 col-md-6 mt-3">
        <p>Note: This practical guide was created using the <a class="text-light" href="https://bookdown.org/yihui/bookdown/">bookdown</a> R package, styled with the modern bs4_book format.</p>
      </div>

    </div>
  </div>
</footer>
</body>
</html>
